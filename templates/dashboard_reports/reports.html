{% extends 'base.html' %} {% block title %}Reports - Helping Hands{% endblock %}
{% block content %}

<style>
  .reports-header {
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    border-radius: 20px;
    padding: 2.5rem;
    margin-bottom: 2rem;
    color: white;
    box-shadow: 0 10px 40px rgba(102, 126, 234, 0.3);
  }
  
  .reports-header h2 {
    font-family: "Poppins", sans-serif;
    font-weight: 800;
    margin: 0;
    font-size: 2.2rem;
  }
  
  .alert-custom {
    border: none;
    border-radius: 16px;
    padding: 1.5rem;
    margin-bottom: 2rem;
    box-shadow: 0 4px 15px rgba(0, 0, 0, 0.08);
  }
  
  .alert-warning {
    background: linear-gradient(135deg, rgba(245, 158, 11, 0.1) 0%, rgba(217, 119, 6, 0.1) 100%);
    border-left: 4px solid #f59e0b;
    color: #92400e;
  }
  
  .alert-success {
    background: linear-gradient(135deg, rgba(16, 185, 129, 0.1) 0%, rgba(5, 150, 105, 0.1) 100%);
    border-left: 4px solid #10b981;
    color: #064e3b;
  }
  
  .export-card {
    background: white;
    border-radius: 16px;
    padding: 2rem;
    box-shadow: 0 4px 15px rgba(0, 0, 0, 0.08);
    margin-bottom: 2rem;
  }
  
  .export-card h5 {
    font-family: "Poppins", sans-serif;
    font-weight: 700;
    color: #333;
    margin-bottom: 1.5rem;
  }
  
  .btn-success {
    background: linear-gradient(135deg, #10b981 0%, #059669 100%);
    border: none;
    border-radius: 50px;
    padding: 0.75rem 1.5rem;
    font-weight: 600;
    margin-right: 1rem;
    margin-bottom: 0.5rem;
    transition: all 0.3s ease;
  }
  
  .btn-success:hover {
    transform: translateY(-3px);
    box-shadow: 0 8px 20px rgba(16, 185, 129, 0.3);
  }
  
  .stat-card {
    background: white;
    border-radius: 16px;
    padding: 1.8rem;
    box-shadow: 0 4px 15px rgba(0, 0, 0, 0.08);
    transition: all 0.3s ease;
    position: relative;
    overflow: hidden;
    margin-bottom: 1.5rem;
  }
  
  .stat-card::before {
    content: "";
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    height: 4px;
    background: linear-gradient(90deg, #667eea 0%, #764ba2 100%);
  }
  
  .stat-card:hover {
    transform: translateY(-10px);
    box-shadow: 0 16px 40px rgba(102, 126, 234, 0.2);
  }
  
  .stat-card h6 {
    font-family: "Poppins", sans-serif;
    font-weight: 600;
    color: #666;
    font-size: 0.9rem;
    margin-bottom: 0.75rem;
    text-transform: uppercase;
    letter-spacing: 0.5px;
  }
  
  .stat-card h3 {
    font-family: "Poppins", sans-serif;
    font-weight: 800;
    font-size: 2.5rem;
    margin: 0;
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
  }
  
  .volunteers-section {
    background: white;
    border-radius: 20px;
    padding: 2rem;
    box-shadow: 0 4px 15px rgba(0, 0, 0, 0.08);
    margin-top: 2rem;
  }
  
  .volunteers-section h4 {
    font-family: "Poppins", sans-serif;
    font-weight: 700;
    color: #333;
    margin-bottom: 1.5rem;
    font-size: 1.5rem;
  }
  
  .volunteers-section h4 i {
    color: #667eea;
    margin-right: 0.5rem;
  }
  
  .table {
    margin: 0;
  }
  
  .table thead th {
    background: linear-gradient(135deg, rgba(102, 126, 234, 0.1) 0%, rgba(118, 75, 162, 0.1) 100%);
    border: none;
    padding: 1rem;
    font-family: "Poppins", sans-serif;
    font-weight: 700;
    color: #333;
    text-transform: uppercase;
    font-size: 0.85rem;
    letter-spacing: 0.5px;
  }
  
  .table tbody tr {
    transition: all 0.3s ease;
    border-bottom: 1px solid #f0f0f0;
  }
  
  .table tbody tr:hover {
    background: rgba(102, 126, 234, 0.05);
    transform: scale(1.01);
  }
  
  .table tbody td {
    padding: 1rem;
    vertical-align: middle;
    color: #666;
    font-weight: 500;
  }
  
  .badge.bg-success {
    background: linear-gradient(135deg, #10b981 0%, #059669 100%) !important;
    padding: 0.5rem 1rem;
    border-radius: 50px;
    font-weight: 700;
    font-size: 1rem;
  }

</style>

<div class="reports-header">
  <h2><i class="bi bi-graph-up"></i> Reports & Analytics</h2>
</div>

{% if is_manager %}
<div class="alert alert-custom alert-warning">
  <i class="bi bi-info-circle"></i> <strong>Manager View:</strong> You are
  viewing reports for <strong>your shifts only</strong>. Admin users can see
  system-wide reports.
</div>
{% else %}
<div class="alert alert-custom alert-success">
  <i class="bi bi-shield-check"></i> <strong>Admin View:</strong> You are
  viewing <strong>system-wide reports</strong> for all shifts and users.
</div>
{% endif %}

<div class="export-card">
  <h5><i class="bi bi-download"></i> Export Data</h5>
  <a href="{% url 'export_shifts_csv' %}" class="btn btn-success"
    ><i class="bi bi-file-earmark-spreadsheet"></i> Export {% if is_manager %}My{% endif %}
    Shifts (CSV)</a
  >
  <a href="{% url 'export_volunteers_csv' %}" class="btn btn-success"
    ><i class="bi bi-people"></i> Export {% if is_manager %}My{% endif %}
    Volunteers (CSV)</a
  >
</div>

<div class="row mt-4">
  <div class="col-md-3">
    <div class="stat-card">
      <h6>Total Shifts</h6>
      <h3>{{ stats.total_shifts }}</h3>
    </div>
  </div>
  <div class="col-md-3">
    <div class="stat-card">
      <h6>Open Shifts</h6>
      <h3>{{ stats.open_shifts }}</h3>
    </div>
  </div>
  <div class="col-md-3">
    <div class="stat-card">
      <h6>Total Applications</h6>
      <h3>{{ stats.total_applications }}</h3>
    </div>
  </div>
  <div class="col-md-3">
    <div class="stat-card">
      <h6>Approved</h6>
      <h3>{{ stats.approved_applications }}</h3>
      </div>
    </div>
  </div>
</div>

{% if top_volunteers %}
<div class="volunteers-section">
  <h4><i class="bi bi-trophy"></i> Top Volunteers</h4>
  <div class="table-responsive">
    <table class="table">
      <thead>
        <tr>
          <th>Volunteer</th>
          <th>Email</th>
          <th>Approved Shifts</th>
        </tr>
      </thead>
      <tbody>
        {% for volunteer in top_volunteers %}
        <tr>
          <td><strong>{{ volunteer.get_full_name }}</strong></td>
          <td>{{ volunteer.email }}</td>
          <td>
            <span class="badge bg-success">{{ volunteer.approved_count }}</span>
          </td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
</div>
{% endif %} {% endblock %}
